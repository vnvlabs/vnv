<div style="display:flex; justify-content:flex-start; margin-bottom:20px;">
    <button type=button class="btn btn-primary" onclick="render_rst()" > Render </button>
    <button type=button class="btn btn-primary" style="margin-left:20px;" onclick="render_comment()" > Copy As Comment </button>

</div>
<div style="display:flex; justify-content:space-between; width:100%; height:75vh; padding=20px;" >

    <div id="rst_editor" style="width:49%; height:100%; overflow:scroll">
    <form id="rst_editor_form" style="width:100%">
       <input id="rst_fileId" type="hidden" name="id"  value="{{fileId}}">
       <input id="rst_dataId" type="hidden" name="dataId" value="{{dataId}}">
       <input id="rst_adataId" type="hidden" name="adataId" value="{{adataId}}">
       <textarea id="rst_content" style="width:100%; border:1px solid lightgray; padding:16px; " name="content" rows="100" >{{content}}</textarea>
    </form>
    </div>
    <iframe src="/files/viewers/rst/render?fileId={{fileId}}&dataId={{dataId}}&adataId={{adataId}}&content=Loading" id="rst_render" style="width:49%; height:100%; overflow:scroll; border:1px solid lightgray; padding:16px;">
    </iframe>

</div>

<script>

function render_rst() {
   fileId = $('#rst_fileId').val()
   dataId =  $('#rst_dataId').val()
   adataId =  $('#rst_adataId').val()
   content =  $('#rst_content').val()
   url = `fileId=${fileId}&dataId=${dataId}&adataId=${adataId}&content=${encodeURIComponent(content)}`
   $('#rst_render').attr("src", "/files/viewers/rst/render?" + url)
}

function render_comment() {
   comment = "/**" + $('#rst_content').val().split(/\r?\n/).join('\n   * ') + "\n   **/"
   navigator.clipboard.writeText(comment);
   addToast("Copied","",1000)
   alert(comment)
}

function set_rst(fileId, dataId, adataId, content) {
    $('#rst_fileId').val(fileId)
    $('#rst_dataId').val(dataId)
    $('#rst_adataId').val(adataId)
    $('#rst_content').val(content)
    render_rst()
}

$( document ).ready(function() {
    render_rst();
});
</script>